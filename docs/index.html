<!doctype html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Timezones</title>
  <script type="module">
    import { setTimeZone, today } from "./datestring.js";

    let timeZone = "";
    let dtf = null; // The date time format
    let optTimeZones = document.getElementById("optTimeZones");
    let outTimeZone = document.getElementById("outTimeZone");
    let outTime = document.getElementById("outTime");
    let outDateString = document.getElementById("outDateString");
    function updateDate() {
      if (timeZone !== optTimeZones.value) {
        timeZone = optTimeZones.value;
        dtf = new Intl.DateTimeFormat("en-AU", {
          timeZone: timeZone,
          day: "numeric",
          month: "numeric",
          year: "numeric",
          hour: "numeric",
          minute: "numeric",
          second: "numeric"
        });
      }

      outTimeZone.textContent = timeZone;

      let text = dtf.format(new Date());
      if (text.substring(0, 1) === "0") text = text.slice(1);
      outTime.textContent = text.replace(",", "").replace("am", "AM").replace("pm", "PM");

      setTimeZone(timeZone);
      outDateString.textContent = today();
    }
    optTimeZones.addEventListener("change", updateDate);
    updateDate();
  </script>
</head>

<body>
  <style>
    body,
    select {
      font-family: sans-serif;
      font-size: 24px;
    }

    * {
      margin: 0;
    }

    body {
      margin-left: 1em;
      margin-top: 1em;
    }
  </style>
  <label for="optTimeZones">Microsoft timezone:</label><br>
  <select id="optTimeZones">
    <option value="Australia/Adelaide">Adelaide</option>
    <option value="Australia/Brisbane">Brisbane</option>
    <option value="Australia/Sydney" selected>Canberra, Melbourne, Sydney</option>
    <option value="Australia/Darwin">Darwin</option>
    <option value="Australia/Hobart">Hobart</option>
    <option value="Australia/Perth">Perth</option>
    <option value="America/Los_Angeles">Pacific Time (US & Canada)</option>
    <option value="Pacific/Auckland">Auckland, Wellington</option>
    <option value="Pacific/Port_Moresby">Guam, Port Moresby</option>
    <option value="Asia/Kolkata">Chennai, Kolkata, Mumbai, New Delhi</option>
  </select>
  <div style="margin-top: 2em;">JS timezone:</div>
  <p id="outTimeZone"></p>
  <p id="outTime"></p>
  <div style="margin-top: 1em;">today():</div>
  <p id="outDateString"></p>
</body>

</html>
